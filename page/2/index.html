<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Codedm的Java小站</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Codedm的Java小站"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Codedm的Java小站"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="Codedm的Java小站"><meta property="og:url" content="https://codedm.com/"><meta property="og:site_name" content="Codedm的Java小站"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://codedm.com/img/og_image.png"><meta property="article:author" content="Codedm"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://codedm.com/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://codedm.com"},"headline":"Codedm的Java小站","image":["https://codedm.com/img/og_image.png"],"author":{"@type":"Person","name":"Codedm"},"publisher":{"@type":"Organization","name":"Codedm的Java小站","logo":{"@type":"ImageObject","url":{"text":"Codedm"}}},"description":""}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.15.2/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="https://fonts.lug.ustc.edu.cn/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><script>var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?84bce1bdcb08243a9d3dcf57d6377a19";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();</script><!--!--><!--!--><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/1.10.0/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.8.1/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-KT5435PTC2" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-KT5435PTC2');</script><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }
          Array
              .from(document.querySelectorAll('.tab-content'))
              .forEach($tab => {
                  $tab.classList.add('is-hidden');
              });
          Array
              .from(document.querySelectorAll('.tabs li'))
              .forEach($tab => {
                  $tab.classList.remove('is-active');
              });
          const $activeTab = document.querySelector(location.hash);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
          const $tabMenu = document.querySelector(`a[href="${location.hash}"]`);
          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.2.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">Codedm</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">主页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/categories/Java%E5%9F%BA%E7%A1%80/">Java基础</a><a class="navbar-item" href="/categories/Java%E8%BF%9B%E9%98%B6/">Java进阶</a><a class="navbar-item" href="/categories/JavaWeb/">JavaWeb</a><a class="navbar-item" href="/categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1/">微服务</a><a class="navbar-item" href="/categories/Flink/">Flink</a><a class="navbar-item" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a><a class="navbar-item" href="/categories/%E7%AE%97%E6%B3%95/">算法</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/about">关于我</a></div><div class="navbar-end"><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><div class="card-image"><a class="image is-7by3" href="/posts/fd4a56f1.html"><img class="fill" src="https://codedm.oss-cn-hangzhou.aliyuncs.com/images/20220809/368fdfeac11741259485eb88646996a4.png?x-oss-process=style/codedm" alt="Java中的面向对象OOP"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-08-08T15:02:00.000Z" title="8/8/2022, 11:02:00 PM">2022-08-08</time>发表</span><span class="level-item"><time dateTime="2022-10-15T13:12:36.895Z" title="10/15/2022, 9:12:36 PM">2022-10-15</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Java%E5%9F%BA%E7%A1%80/">Java基础</a></span><span class="level-item">8 分钟读完 (大约1227个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/posts/fd4a56f1.html">Java中的面向对象OOP</a></h1><div class="content"><p><a target="_blank" rel="noopener" href="https://github.com/Code-dm/Re-learning-Java/issues/7">本篇文章对应的Issues，Issues代表我文章创作的过程。(点击我)</a><br>面向对象OOP（Object-oriented programming）</p></div><a class="article-more button is-small is-size-7" href="/posts/fd4a56f1.html#more">阅读更多</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-08-16T16:00:00.000Z" title="8/17/2022, 12:00:00 AM">2022-08-17</time>发表</span><span class="level-item"><time dateTime="2022-09-09T03:56:01.012Z" title="9/9/2022, 11:56:01 AM">2022-09-09</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a></span><span class="level-item">几秒读完 (大约65个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/posts/12990ea5.html">Kerberos常用命令</a></h1><div class="content"><p>通过keytab文件查找Principal</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">klist -kte /etc/security/keytabs/flink.keytab</span><br></pre></td></tr></table></figure>
<p>命令行kerberos认证：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kinit -kt /etc/security/keytabs/flink_platform.service.keytab yarn/dn90210@DDP.COM</span><br></pre></td></tr></table></figure>

<p>.&#x2F;bin&#x2F;yarn-session.sh -d -jm 1024m -tm 2048 -s 1</p>
<p>bin&#x2F;sql-gateway.sh start-foreground -D sql-gateway.endpoint.type&#x3D;rest -D sql-gateway.endpoint.rest.address&#x3D;localhost</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-09-07T03:00:00.000Z" title="9/7/2022, 11:00:00 AM">2022-09-07</time>发表</span><span class="level-item"><time dateTime="2022-11-09T08:16:35.219Z" title="11/9/2022, 4:16:35 PM">2022-11-09</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Flink/">Flink</a></span><span class="level-item">7 分钟读完 (大约1022个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/posts/e220ca62.html">Flink Hive Connector 实战使用</a></h1><div class="content"><p><a target="_blank" rel="noopener" href="https://github.com/Code-dm/Re-learning-Java/issues/11">本篇文章对应的Issues，Issues代表我文章创作的过程。(点击我)</a></p></div><a class="article-more button is-small is-size-7" href="/posts/e220ca62.html#more">阅读更多</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-09-07T03:00:00.000Z" title="9/7/2022, 11:00:00 AM">2022-09-07</time>发表</span><span class="level-item"><time dateTime="2022-10-15T13:12:36.912Z" title="10/15/2022, 9:12:36 PM">2022-10-15</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Flink/">Flink</a></span><span class="level-item">5 分钟读完 (大约822个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/posts/f3b4a32a.html">Flink Hive Connector 简介</a></h1><div class="content"><p><a target="_blank" rel="noopener" href="https://github.com/Code-dm/Re-learning-Java/issues/11">本篇文章对应的Issues，Issues代表我文章创作的过程。(点击我)</a></p>
<blockquote>
<p>本文基于：Flink-1.15</p>
</blockquote>
<h1 id="简介什么是Hive"><a href="#简介什么是Hive" class="headerlink" title="简介什么是Hive"></a>简介什么是Hive</h1><p>如果是了解过Hive以及Flink，这些简介请直接跳过。</p>
<h2 id="Apache-Hive官网的描述"><a href="#Apache-Hive官网的描述" class="headerlink" title="Apache Hive官网的描述"></a>Apache Hive官网的描述</h2><blockquote>
<p>The Apache Hive ™ data warehouse software facilitates reading, writing, and managing large datasets residing in distributed storage using SQL. Structure can be projected onto data already in storage. A command line tool and JDBC driver are provided to connect users to Hive.</p>
</blockquote>
<p>Apache Hive是数据仓库的一种工具，用来读、写和管理分布式存储（例如：HDFS）中的大型的数据集。<br>他可以把结构映射到存储的文件上。可以通过命令行工具和JDBC驱动来连接Hive。<br>数据仓库收集企业中各个业务系统的数据进行集中化管理，Apache Hive可以作为数据仓库管理的一种工具。同时可以知道Hive本身是不存储数据的，他管理的是分布式存储系统中文件和结构的映射关系。<br>例如：HDFS上有一个CSV文件，这个CSV文件使用 <code>,</code> 号进行分割</p></div><a class="article-more button is-small is-size-7" href="/posts/f3b4a32a.html#more">阅读更多</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-09-13T03:00:00.000Z" title="9/13/2022, 11:00:00 AM">2022-09-13</time>发表</span><span class="level-item"><time dateTime="2022-10-15T13:12:36.918Z" title="10/15/2022, 9:12:36 PM">2022-10-15</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Flink/">Flink</a></span><span class="level-item">5 分钟读完 (大约736个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/posts/31388dbe.html">Flink Hive Connector创建Catalog的原理</a></h1><div class="content"><p><a target="_blank" rel="noopener" href="https://github.com/Code-dm/Re-learning-Java/issues/11">本篇文章对应的Issues，Issues代表我文章创作的过程。(点击我)</a></p>
<blockquote>
<p>本文基于：Flink-1.15</p>
</blockquote>
<h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>在sql-client中使用Hive Connector之前常规都是需要将Flink和Hive Metastore连接起来，从Hive Metastore中获取Hive的元数据，方便我们直接操作Hive中的一些表。同时我们在sql-client中创建对表也可以持久化在Hive Metastore中。<br>使用Flink HiveCatalog可以连接到Hive Metastore，这边文章主要来了解HiveCatalog的实现。</p></div><a class="article-more button is-small is-size-7" href="/posts/31388dbe.html#more">阅读更多</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-09-14T03:00:00.000Z" title="9/14/2022, 11:00:00 AM">2022-09-14</time>发表</span><span class="level-item"><time dateTime="2022-10-15T13:12:36.907Z" title="10/15/2022, 9:12:36 PM">2022-10-15</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Flink/">Flink</a></span><span class="level-item">14 分钟读完 (大约2110个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/posts/76537a8.html">Flink Hive Connector读写源码解析</a></h1><div class="content"><p><a target="_blank" rel="noopener" href="https://github.com/Code-dm/Re-learning-Java/issues/11">本篇文章对应的Issues，Issues代表我文章创作的过程。(点击我)</a><br>Flink实现Hive中表数据的读写操作首先要获取到每张表的元数据，通过表的元数据信息才能获取到数据文件的存储路径、存储格式、是否分区、分区规则。这样才能从HDFS对应的路径中获取到对应的数据，并使用对应的存储格式来解析文件。<br>Flink Hive的读写同样使用Connector通用架构新Source（<a target="_blank" rel="noopener" href="https://cwiki.apache.org/confluence/display/FLINK/FLIP-27%3A+Refactor+Source+Interface">FLIP-27</a>）和Sink。</p></div><a class="article-more button is-small is-size-7" href="/posts/76537a8.html#more">阅读更多</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-09-21T03:00:00.000Z" title="9/21/2022, 11:00:00 AM">2022-09-21</time>发表</span><span class="level-item"><time dateTime="2022-10-15T13:12:36.916Z" title="10/15/2022, 9:12:36 PM">2022-10-15</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Flink/">Flink</a></span><span class="level-item">2 分钟读完 (大约342个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/posts/805c09f3.html">Flink如何适配Hive中不同的数据存储格式</a></h1><div class="content"><p><a target="_blank" rel="noopener" href="https://github.com/Code-dm/Re-learning-Java/issues/11">本篇文章对应的Issues，Issues代表我文章创作的过程。(点击我)</a></p></div><a class="article-more button is-small is-size-7" href="/posts/805c09f3.html#more">阅读更多</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-10-11T09:00:00.000Z" title="10/11/2022, 5:00:00 PM">2022-10-11</time>发表</span><span class="level-item"><time dateTime="2022-12-01T08:00:18.714Z" title="12/1/2022, 4:00:18 PM">2022-12-01</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Flink/">Flink</a></span><span class="level-item">17 分钟读完 (大约2601个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/posts/573ecee0.html">Flink Hive 合并小文件原理</a></h1><div class="content"><h1 id="服务版本"><a href="#服务版本" class="headerlink" title="服务版本"></a>服务版本</h1><ul>
<li>Flink 1.5.2</li>
<li>MySQL 5.7.34 </li>
<li>Flink CDC 2.2.1</li>
<li>Hive 3.0.0</li>
</ul>
<h1 id="同步场景"><a href="#同步场景" class="headerlink" title="同步场景"></a>同步场景</h1><p>我们的订单系统数据存储在事务型数据库MySQL中，订单系统中有一个核心的表<code>order</code>表。我们需要将<code>order</code>表中的数据实时同步到Hive的数据仓库中。<br>Hive中的<code>order</code>表是根据订单时间的分区表。<code>order</code>表中<code>order_date</code>字段是下单时间，下单时间业务方设计是数据插入时间，由数据库<code>now()</code>函数生成。由于业务系统会有删除数据的情况，所以在Hive中需要能够有一个字段标识数据的状态。</p>
<h1 id="同步配置"><a href="#同步配置" class="headerlink" title="同步配置"></a>同步配置</h1><h2 id="Flink-集群安装"><a href="#Flink-集群安装" class="headerlink" title="Flink 集群安装"></a>Flink 集群安装</h2><p>Flink和Hive配置见文章：<a href="">Flink和Hive配置</a></p>
<h2 id="Flink-CDC-依赖安装"><a href="#Flink-CDC-依赖安装" class="headerlink" title="Flink CDC 依赖安装"></a>Flink CDC 依赖安装</h2><p>本次测试我们使用<code>SQL Client</code>进行SQL任务的提交。<br>下载 <a target="_blank" rel="noopener" href="https://repo1.maven.org/maven2/com/ververica/flink-sql-connector-mysql-cdc/2.2.1/flink-sql-connector-mysql-cdc-2.2.1.jar">flink-sql-connector-mysql-cdc-2.3-SNAPSHOT.jar</a> 到 <FLINK_HOME>&#x2F;lib&#x2F; 目录下。<br>下载 <a target="_blank" rel="noopener" href="https://repo1.maven.org/maven2/mysql/mysql-connector-java/8.0.28/mysql-connector-java-8.0.28.jar">mysql-connector-java-8.0.28.jar</a> 到 <FLINK_HOME>&#x2F;lib&#x2F; 目录下。 </p>
<blockquote>
<p>注意：如果您已经启动Flink集群，添加上述依赖后需要对集群进行重启。</p>
</blockquote>
<h2 id="MySQL配置"><a href="#MySQL配置" class="headerlink" title="MySQL配置"></a>MySQL配置</h2><p>MySQL需要开启BinLog日志。<br>安装见：<a href="">Docker安装MySQL</a><br>建库建表：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> NAMES utf8mb4;</span><br><span class="line"><span class="keyword">SET</span> FOREIGN_KEY_CHECKS <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> DATABASE `db_order`;</span><br><span class="line">USE db_order;</span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for t_order</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `t_order`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `t_order` (</span><br><span class="line">  `order_id` <span class="type">int</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `order_date` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `customer_name` <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `price` <span class="type">decimal</span>(<span class="number">10</span>,<span class="number">5</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `product_id` <span class="type">int</span>(<span class="number">10</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `order_status` bit(<span class="number">1</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`order_id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `db_order`.`t_order` (`order_id`, `order_date`, `customer_name`, `price`, `product_id`, `order_status`) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;2022-10-12 15:14:36&#x27;</span>, <span class="string">&#x27;客户1&#x27;</span>, <span class="number">129.14200</span>, <span class="number">10001</span>, b<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `db_order`.`t_order` (`order_id`, `order_date`, `customer_name`, `price`, `product_id`, `order_status`) <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">&#x27;2022-10-12 15:14:36&#x27;</span>, <span class="string">&#x27;客户2&#x27;</span>, <span class="number">130.14200</span>, <span class="number">10002</span>, b<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `db_order`.`t_order` (`order_id`, `order_date`, `customer_name`, `price`, `product_id`, `order_status`) <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="string">&#x27;2022-10-12 15:14:36&#x27;</span>, <span class="string">&#x27;客户3&#x27;</span>, <span class="number">130.14200</span>, <span class="number">10003</span>, b<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `db_order`.`t_order` (`order_id`, `order_date`, `customer_name`, `price`, `product_id`, `order_status`) <span class="keyword">VALUES</span> (<span class="number">5</span>, <span class="string">&#x27;2022-10-13 15:14:36&#x27;</span>, <span class="string">&#x27;客户5&#x27;</span>, <span class="number">130.14200</span>, <span class="number">10003</span>, b<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> `db_order`.`t_order` <span class="keyword">where</span> order_id <span class="operator">=</span> <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">UPDATE</span> `db_order`.`t_order` <span class="keyword">SET</span> `order_date` <span class="operator">=</span> <span class="string">&#x27;2022-10-12 15:14:36&#x27;</span>, `customer_name` <span class="operator">=</span> <span class="string">&#x27;客户22&#x27;</span>, `price` <span class="operator">=</span> <span class="number">130.14200</span>, `product_id` <span class="operator">=</span> <span class="number">10002</span>, `order_status` <span class="operator">=</span> b<span class="string">&#x27;0&#x27;</span> <span class="keyword">WHERE</span> `order_id` <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> FOREIGN_KEY_CHECKS <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<h2 id="Hive-配置"><a href="#Hive-配置" class="headerlink" title="Hive 配置"></a>Hive 配置</h2><p>Hive中创建分区表，<code>order_date</code>订单时间，使用订单时间的年、月、日作为三个分区字段。表的存储格式使用ORC格式。<br>使用Hive的sql-client执行建表语句，或者使用Flink的sql-client，如果使用flink sql-client，需要切换成Hive方言<code>SET &#39;table.sql-dialect&#39; = &#39;hive&#39;;</code></p>
<blockquote>
<p><strong><em>NOTE:</em></strong> </p>
<ul>
<li>为了使用 Hive 方言, 你必须首先添加和 Hive 相关的依赖. 请参考 <a target="_blank" rel="noopener" href="https://nightlies.apache.org/flink/flink-docs-release-1.16/zh/docs/connectors/table/hive/overview/#dependencies">Hive dependencies</a> 如何添加这些依赖。</li>
<li>从 Flink 1.15版本开始，如果需要使用 Hive 方言的话，请首先将 FLINK_HOME&#x2F;opt 下面的 flink-table-planner_2.12 jar 包放到 FLINK_HOME&#x2F;lib 下，并将 FLINK_HOME&#x2F;lib 下的 flink-table-planner-loader jar 包移出 FLINK_HOME&#x2F;lib 目录。否则将抛出 ValidationException。具体原因请参考 <a target="_blank" rel="noopener" href="https://issues.apache.org/jira/browse/FLINK-25128">FLINK-25128</a>。</li>
<li>请确保当前的 Catalog 是 <a target="_blank" rel="noopener" href="https://nightlies.apache.org/flink/flink-docs-release-1.16/zh/docs/connectors/table/hive/hive_catalog/">HiveCatalog</a>. 否则, 将使用 Flink 的默认方言。 在启动了 HiveServer2 endpoint 的 SQL Gateway，默认当前的 Catalog 就是 HiveCatalog。</li>
<li>为了实现更好的语法和语义的兼容，强烈建议首先加载 <a target="_blank" rel="noopener" href="https://nightlies.apache.org/flink/flink-docs-release-1.16/zh/docs/connectors/table/hive/hive_functions/#use-hive-built-in-functions-via-hivemodule">HiveModule</a> 并将其放在 Module 列表的首位，以便在函数解析时优先使用 Hive 内置函数。 请参考文档 <a target="_blank" rel="noopener" href="https://nightlies.apache.org/flink/flink-docs-release-1.16/zh/docs/dev/table/modules/#how-to-load-unload-use-and-list-modules">here</a> 来将 HiveModule 放在 Module 列表的首。 在启动了 HiveServer2 endpoint 的 SQL Gateway，HiveModule 已经被加载进来了。</li>
<li>Hive 方言只支持 db.table 这种两级的标识符，不支持带有 Catalog 名字的标识符。</li>
<li>虽然所有 Hive 版本支持相同的语法，但是一些特定的功能是否可用仍取决于你使用的 <a target="_blank" rel="noopener" href="https://nightlies.apache.org/flink/flink-docs-release-1.16/zh/docs/connectors/table/hive/overview/#%e6%94%af%e6%8c%81%e7%9a%84hive%e7%89%88%e6%9c%ac">Hive 版本</a>。例如，更新数据库位置 只在 Hive-2.4.0 或更高版本支持。</li>
<li>Hive 方言主要是在批模式下使用的，某些 Hive 的语法(<a target="_blank" rel="noopener" href="https://nightlies.apache.org/flink/flink-docs-release-1.16/zh/docs/dev/table/hive-compatibility/hive-dialect/queries/sort-cluster-distribute-by/">Sort&#x2F;Cluster&#x2F;Distributed BY</a>, <a target="_blank" rel="noopener" href="https://nightlies.apache.org/flink/flink-docs-release-1.16/zh/docs/dev/table/hive-compatibility/hive-dialect/queries/transform/">Transform</a>, 等)还没有在流模式下支持。</li>
</ul>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> order_orc_no_policy</span><br><span class="line">(</span><br><span class="line">    order_id <span class="type">int</span>,</span><br><span class="line">    order_date <span class="type">Timestamp</span>,</span><br><span class="line">    customer_name string,</span><br><span class="line">    price <span class="type">decimal</span>(<span class="number">10</span>, <span class="number">5</span>),</span><br><span class="line">    product_id <span class="type">int</span>,</span><br><span class="line">    order_status <span class="type">BOOLEAN</span>,</span><br><span class="line">    op string,</span><br><span class="line">    `kafka_timestamp` <span class="type">TIMESTAMP</span></span><br><span class="line">) COMMENT <span class="string">&#x27;order_orc&#x27;</span> PARTITIONED <span class="keyword">BY</span></span><br><span class="line">(</span><br><span class="line">    `order_date_dt` string,</span><br><span class="line">    `order_date_hr` string</span><br><span class="line">)</span><br><span class="line">    <span class="type">ROW</span> FORMAT SERDE <span class="string">&#x27;org.apache.hadoop.hive.ql.io.orc.OrcSerde&#x27;</span></span><br><span class="line">    <span class="keyword">with</span> serdeproperties(<span class="string">&#x27;serialization.null.format&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    STORED <span class="keyword">AS</span> ORC    </span><br><span class="line">    TBLPROPERTIES</span><br><span class="line">    (</span><br><span class="line">    <span class="string">&#x27;sink.partition-commit.policy.kind&#x27;</span><span class="operator">=</span><span class="string">&#x27;metastore,success-file&#x27;</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> myhive.yyq.order_orc_no_policy <span class="keyword">select</span> order_id, order_date, customer_name, price, product_id, order_status, type, `<span class="type">timestamp</span>`, DATE_FORMAT(order_date, <span class="string">&#x27;yyyy-MM-dd&#x27;</span>), DATE_FORMAT(order_date, <span class="string">&#x27;HH&#x27;</span>) <span class="keyword">from</span> default_catalog.default_database.k_order_read;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> order_orc_auto_compaction</span><br><span class="line">(</span><br><span class="line">    order_id <span class="type">int</span>,</span><br><span class="line">    order_date <span class="type">Timestamp</span>,</span><br><span class="line">    customer_name string,</span><br><span class="line">    price <span class="type">decimal</span>(<span class="number">10</span>, <span class="number">5</span>),</span><br><span class="line">    product_id <span class="type">int</span>,</span><br><span class="line">    order_status <span class="type">BOOLEAN</span>,</span><br><span class="line">    op string,</span><br><span class="line">    `kafka_timestamp` <span class="type">TIMESTAMP</span></span><br><span class="line">    ) COMMENT <span class="string">&#x27;order_orc&#x27;</span> PARTITIONED <span class="keyword">BY</span></span><br><span class="line">(</span><br><span class="line">    `order_date_dt` string,</span><br><span class="line">    `order_date_hr` string</span><br><span class="line">)</span><br><span class="line">    <span class="type">ROW</span> FORMAT SERDE <span class="string">&#x27;org.apache.hadoop.hive.ql.io.orc.OrcSerde&#x27;</span></span><br><span class="line">    <span class="keyword">with</span> serdeproperties(<span class="string">&#x27;serialization.null.format&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    STORED <span class="keyword">AS</span> ORC</span><br><span class="line">    TBLPROPERTIES</span><br><span class="line">(   <span class="string">&#x27;auto-compaction&#x27;</span><span class="operator">=</span><span class="string">&#x27;true&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;compaction.file-size&#x27;</span><span class="operator">=</span><span class="string">&#x27;128MB&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;sink.partition-commit.policy.kind&#x27;</span><span class="operator">=</span><span class="string">&#x27;metastore,success-file&#x27;</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> myhive.yyq.order_orc_auto_compaction <span class="keyword">select</span> order_id, order_date, customer_name, price, product_id, order_status, type, `<span class="type">timestamp</span>`, DATE_FORMAT(order_date, <span class="string">&#x27;yyyy-MM-dd&#x27;</span>), DATE_FORMAT(order_date, <span class="string">&#x27;HH&#x27;</span>) <span class="keyword">from</span> default_catalog.default_database.k_order_read;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> order_orc_partition_commit</span><br><span class="line">(</span><br><span class="line">    order_id <span class="type">int</span>,</span><br><span class="line">    order_date <span class="type">Timestamp</span>,</span><br><span class="line">    customer_name string,</span><br><span class="line">    price <span class="type">decimal</span>(<span class="number">10</span>, <span class="number">5</span>),</span><br><span class="line">    product_id <span class="type">int</span>,</span><br><span class="line">    order_status <span class="type">BOOLEAN</span>,</span><br><span class="line">    op string,</span><br><span class="line">    `kafka_timestamp` <span class="type">TIMESTAMP</span></span><br><span class="line">    ) COMMENT <span class="string">&#x27;order_orc&#x27;</span> PARTITIONED <span class="keyword">BY</span></span><br><span class="line">(</span><br><span class="line">    `order_date_dt` string,</span><br><span class="line">    `order_date_hr` string,</span><br><span class="line">    `order_date_min` string</span><br><span class="line">)</span><br><span class="line">    <span class="type">ROW</span> FORMAT SERDE <span class="string">&#x27;org.apache.hadoop.hive.ql.io.orc.OrcSerde&#x27;</span></span><br><span class="line">    <span class="keyword">with</span> serdeproperties(<span class="string">&#x27;serialization.null.format&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    STORED <span class="keyword">AS</span> ORC</span><br><span class="line">    TBLPROPERTIES</span><br><span class="line">(</span><br><span class="line">    <span class="string">&#x27;sink.partition-commit.trigger&#x27;</span><span class="operator">=</span><span class="string">&#x27;process-time&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;sink.partition-commit.delay&#x27;</span><span class="operator">=</span><span class="string">&#x27;0s&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;sink.partition-commit.watermark-time-zone&#x27;</span><span class="operator">=</span><span class="string">&#x27;Asia/Shanghai&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;sink.partition-commit.policy.kind&#x27;</span><span class="operator">=</span><span class="string">&#x27;metastore,success-file&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;sink.parallelism&#x27;</span><span class="operator">=</span><span class="string">&#x27;5&#x27;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> myhive.yyq.order_orc_partition_commit <span class="keyword">select</span> order_id, order_date, customer_name, price, product_id, order_status, type, `<span class="type">timestamp</span>`, DATE_FORMAT(order_date, <span class="string">&#x27;yyyy-MM-dd&#x27;</span>), DATE_FORMAT(order_date, <span class="string">&#x27;HH&#x27;</span>), DATE_FORMAT(order_date, <span class="string">&#x27;mm&#x27;</span>) <span class="keyword">from</span> default_catalog.default_database.k_order_read;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> order_orc_partition_commit_and_auto_compaction</span><br><span class="line">(</span><br><span class="line">    order_id <span class="type">int</span>,</span><br><span class="line">    order_date <span class="type">Timestamp</span>,</span><br><span class="line">    customer_name string,</span><br><span class="line">    price <span class="type">decimal</span>(<span class="number">10</span>, <span class="number">5</span>),</span><br><span class="line">    product_id <span class="type">int</span>,</span><br><span class="line">    order_status <span class="type">BOOLEAN</span>,</span><br><span class="line">    op string,</span><br><span class="line">    `kafka_timestamp` <span class="type">TIMESTAMP</span></span><br><span class="line">    ) COMMENT <span class="string">&#x27;order_orc&#x27;</span> PARTITIONED <span class="keyword">BY</span></span><br><span class="line">(</span><br><span class="line">    `order_date_dt` string,</span><br><span class="line">    `order_date_hr` string,</span><br><span class="line">    `order_date_min` string</span><br><span class="line">)</span><br><span class="line">    <span class="type">ROW</span> FORMAT SERDE <span class="string">&#x27;org.apache.hadoop.hive.ql.io.orc.OrcSerde&#x27;</span></span><br><span class="line">    <span class="keyword">with</span> serdeproperties(<span class="string">&#x27;serialization.null.format&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    STORED <span class="keyword">AS</span> ORC</span><br><span class="line">    TBLPROPERTIES</span><br><span class="line">(</span><br><span class="line">    <span class="string">&#x27;sink.partition-commit.trigger&#x27;</span><span class="operator">=</span><span class="string">&#x27;process-time&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;sink.partition-commit.delay&#x27;</span><span class="operator">=</span><span class="string">&#x27;0s&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;sink.partition-commit.watermark-time-zone&#x27;</span><span class="operator">=</span><span class="string">&#x27;Asia/Shanghai&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;sink.partition-commit.policy.kind&#x27;</span><span class="operator">=</span><span class="string">&#x27;metastore,success-file&#x27;</span>,</span><br><span class="line">    </span><br><span class="line">    <span class="string">&#x27;sink.parallelism&#x27;</span><span class="operator">=</span><span class="string">&#x27;3&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;auto-compaction&#x27;</span><span class="operator">=</span><span class="string">&#x27;true&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;compaction.file-size&#x27;</span><span class="operator">=</span><span class="string">&#x27;128MB&#x27;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> myhive.yyq.order_orc_partition_commit_and_auto_compaction <span class="keyword">select</span> order_id, order_date, customer_name, price, product_id, order_status, type, `<span class="type">timestamp</span>`, DATE_FORMAT(order_date, <span class="string">&#x27;yyyy-MM-dd&#x27;</span>), DATE_FORMAT(order_date, <span class="string">&#x27;HH&#x27;</span>), DATE_FORMAT(order_date, <span class="string">&#x27;mm&#x27;</span>) <span class="keyword">from</span> default_catalog.default_database.k_order_read;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="开始同步"><a href="#开始同步" class="headerlink" title="开始同步"></a>开始同步</h1><blockquote>
<p>同步之前请确保<code>SQL Client</code>已经注册Hive CATALOG，Flink CDC可以正常访问MySQL。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 设置checkpoint间隔时间为10s，生产环境建议2-3分钟 </span></span><br><span class="line"><span class="keyword">SET</span> <span class="string">&#x27;execution.checkpointing.interval&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;30s&#x27;</span>;</span><br><span class="line">    </span><br><span class="line"><span class="comment">-- 创建连接MySQL BinLog的Flink表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> f_order (</span><br><span class="line">     order_id <span class="type">INT</span>,</span><br><span class="line">     order_date <span class="type">TIMESTAMP</span>(<span class="number">0</span>),</span><br><span class="line">     customer_name STRING,</span><br><span class="line">     price <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">5</span>),</span><br><span class="line">     product_id <span class="type">INT</span>,</span><br><span class="line">     order_status <span class="type">BOOLEAN</span>,</span><br><span class="line">     <span class="keyword">PRIMARY</span> KEY(order_id) <span class="keyword">NOT</span> ENFORCED</span><br><span class="line">     ) <span class="keyword">WITH</span> (</span><br><span class="line">     <span class="string">&#x27;connector&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;mysql-cdc&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;hostname&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;192.168.80.92&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;port&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;3308&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;username&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;password&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;123456&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;database-name&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;db_order&#x27;</span>,</span><br><span class="line">     <span class="string">&#x27;table-name&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;t_order&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> f_order;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> <span class="string">&#x27;execution.savepoint.path&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;hdfs://dn8092:8020/flink/checkpoints/fd2b980717b5ca23efb1be219bdd8c14/chk-3&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>测试Flink CDC能不能正常获取MySQL的BinLog。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> f_order;</span><br><span class="line"><span class="comment">-- 按 q 退出查询</span></span><br></pre></td></tr></table></figure>
<p>如果能够正常获取则显示下图，最新数据的获取刷新是根据<code>SET &#39;execution.checkpointing.interval&#39; = &#39;10s&#39;;</code>的配置间隔显示。<br><img src="https://codedm.oss-cn-hangzhou.aliyuncs.com/images/20221012/61f7f79529004bb7809e8bc96961c8b0.png?x-oss-process=style/codedm" alt="获取MySQL BinLog数据"></p>
<p>将数据MySQL BinLog数据使用canal格式写入Kafka中</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建Kafka连接表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> k_order_write_canal(</span><br><span class="line">    order_id <span class="type">INT</span>,</span><br><span class="line">    order_date <span class="type">TIMESTAMP</span>(<span class="number">0</span>),</span><br><span class="line">    customer_name STRING,</span><br><span class="line">    price <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">5</span>),</span><br><span class="line">    product_id <span class="type">INT</span>,</span><br><span class="line">    order_status <span class="type">BOOLEAN</span>,</span><br><span class="line">    op STRING METADATA <span class="keyword">FROM</span> <span class="string">&#x27;op&#x27;</span> VIRTUAL,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY(order_id) <span class="keyword">NOT</span> ENFORCED</span><br><span class="line">) <span class="keyword">WITH</span> (</span><br><span class="line">    <span class="string">&#x27;connector&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;kafka&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;topic&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;flink-cdc-kafka-order&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;properties.bootstrap.servers&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;dn90222:6667,dn90224:6667,dn90225:6667,dn90226:6667&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;properties.group.id&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;flink-cdc-kafka-group&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;value.format&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;canal-json&#x27;</span>,</span><br><span class="line">    </span><br><span class="line">    <span class="string">&#x27;properties.security.protocol&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;SASL_PLAINTEXT&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;properties.sasl.mechanism&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;GSSAPI&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;properties.sasl.kerberos.service.name&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;kafka&#x27;</span>,</span><br><span class="line">    </span><br><span class="line">    <span class="string">&#x27;properties.allow.auto.create.topics&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;true&#x27;</span></span><br><span class="line">    );</span><br><span class="line"><span class="comment">-- 将 MySQL BinLog数据写入 Kafka中</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> k_order_write_canal <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> f_order;</span><br></pre></td></tr></table></figure>
<p>将数据从Kafka中同步到Hive</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建Kafka读表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> k_order_read(</span><br><span class="line">    data <span class="keyword">ARRAY</span><span class="operator">&lt;</span><span class="type">ROW</span><span class="operator">&lt;</span></span><br><span class="line">        order_id <span class="type">INT</span>,</span><br><span class="line">        order_date <span class="type">TIMESTAMP</span>(<span class="number">0</span>),</span><br><span class="line">        customer_name STRING,</span><br><span class="line">        price <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">5</span>),</span><br><span class="line">        product_id <span class="type">INT</span>,</span><br><span class="line">        order_status <span class="type">BOOLEAN</span><span class="operator">&gt;&gt;</span>,</span><br><span class="line">    order_id <span class="keyword">as</span> data[<span class="number">1</span>].order_id,</span><br><span class="line">    order_date <span class="keyword">as</span> data[<span class="number">1</span>].order_date,</span><br><span class="line">    customer_name <span class="keyword">as</span> data[<span class="number">1</span>].customer_name,</span><br><span class="line">    price <span class="keyword">as</span> data[<span class="number">1</span>].price,</span><br><span class="line">    product_id <span class="keyword">as</span> data[<span class="number">1</span>].product_id,</span><br><span class="line">    order_status <span class="keyword">as</span> data[<span class="number">1</span>].order_status,</span><br><span class="line">    `type` STRING,</span><br><span class="line">    `<span class="type">timestamp</span>` <span class="type">TIMESTAMP</span>(<span class="number">3</span>) METADATA <span class="keyword">FROM</span> <span class="string">&#x27;timestamp&#x27;</span>,</span><br><span class="line">    WATERMARK <span class="keyword">FOR</span> order_date <span class="keyword">AS</span> order_date <span class="operator">-</span> <span class="type">INTERVAL</span> <span class="string">&#x27;5&#x27;</span> <span class="keyword">SECOND</span></span><br><span class="line">) <span class="keyword">WITH</span> (</span><br><span class="line">      <span class="string">&#x27;connector&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;kafka&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;topic&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;flink-cdc-kafka-order&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;properties.bootstrap.servers&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;dn90222:6667,dn90224:6667,dn90225:6667,dn90226:6667&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;properties.group.id&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;flink-cdc-kafka-group&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;value.format&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;json&#x27;</span>,</span><br><span class="line"></span><br><span class="line">      <span class="string">&#x27;properties.security.protocol&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;SASL_PLAINTEXT&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;properties.sasl.mechanism&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;GSSAPI&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;properties.sasl.kerberos.service.name&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;kafka&#x27;</span>,</span><br><span class="line"></span><br><span class="line">      <span class="string">&#x27;properties.allow.auto.create.topics&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;true&#x27;</span></span><br><span class="line">      );</span><br><span class="line"><span class="comment">-- 同步前请确保Hive的Catalog已经注册</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> myhive.yyq.order_orc <span class="keyword">select</span> order_id, order_date, customer_name, price, product_id, order_status, type, `<span class="type">timestamp</span>`, DATE_FORMAT(order_date, <span class="string">&#x27;yyyy-MM-dd&#x27;</span>), DATE_FORMAT(order_date, <span class="string">&#x27;HH&#x27;</span>) <span class="keyword">from</span> default_catalog.default_database.k_order_read;</span><br></pre></td></tr></table></figure>
<p>在Hive中是历史拉链表，所有的增删改都有记录，通过下面SQL可以过滤掉删除的、旧的数据。<br><img src="https://codedm.oss-cn-hangzhou.aliyuncs.com/images/20221014/378863e857144c7b90f466941cd0363c.png?x-oss-process=style/codedm" alt="拉链表数据"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> (<span class="keyword">select</span> order_id, <span class="built_in">max</span>(kafka_timestamp) <span class="keyword">as</span> tp <span class="keyword">from</span> order_orc <span class="keyword">group</span> <span class="keyword">by</span> order_id) t </span><br><span class="line"> <span class="keyword">join</span> order_orc oc <span class="keyword">on</span> t.order_id <span class="operator">=</span> oc.order_id <span class="keyword">and</span> t.tp <span class="operator">=</span> oc.kafka_timestamp <span class="keyword">where</span> oc.op <span class="operator">!=</span> <span class="string">&#x27;DELETE&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h1 id="配置解析"><a href="#配置解析" class="headerlink" title="配置解析"></a>配置解析</h1><p>我们在创建Hive表的时候增加了几个特殊的配置：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x27;partition.time-extractor.timestamp-pattern&#x27;=&#x27;$order_date_dt $order_date_hr:00:00&#x27;,</span><br><span class="line">&#x27;sink.partition-commit.trigger&#x27;=&#x27;partition-time&#x27;,</span><br><span class="line">&#x27;sink.partition-commit.delay&#x27;=&#x27;3 m&#x27;,</span><br><span class="line">&#x27;sink.partition-commit.watermark-time-zone&#x27;=&#x27;Asia/Shanghai&#x27;,</span><br><span class="line">&#x27;sink.partition-commit.policy.kind&#x27;=&#x27;metastore,success-file&#x27;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>partition.time-extractor.timestamp-pattern</code></li>
<li><code>sink.partition-commit.trigger</code></li>
<li><code>sink.partition-commit.delay</code></li>
<li><code>sink.partition-commit.watermark-time-zone</code></li>
<li><code>sink.partition-commit.policy.kind</code></li>
</ul>
<p><img src="https://codedm.oss-cn-hangzhou.aliyuncs.com/images/20221018/a715b76a886546d194a7e9b72835afb7.png?x-oss-process=style/codedm" alt="no_policy生成的文件"><br><img src="https://codedm.oss-cn-hangzhou.aliyuncs.com/images/20221018/e2d4a721124e40bb98890af606adbef2.png?x-oss-process=style/codedm" alt="no_policy文件生成含文件大小"></p>
<p><img src="https://codedm.oss-cn-hangzhou.aliyuncs.com/images/20221018/1229460276724ee1834e50338e7e7d5d.png?x-oss-process=style/codedm" alt="开启自动压缩DAG图"><br><img src="https://codedm.oss-cn-hangzhou.aliyuncs.com/images/20221018/46c829bd14a24e21821f173527c69a2c.png?x-oss-process=style/codedm" alt="开启自动压缩，生成的文件列表"></p>
<p><img src="https://codedm.oss-cn-hangzhou.aliyuncs.com/images/20221025/0df1fb0406604a0b88f5fdb779d3d0ed.png?x-oss-process=style/codedm" alt="并行度为5的DAG图"><br><img src="https://codedm.oss-cn-hangzhou.aliyuncs.com/images/20221025/01bd3b77058c4c009c8590129fd03919.png?x-oss-process=style/codedm" alt="并行度为5生成的文件列表"></p>
<p><img src="https://codedm.oss-cn-hangzhou.aliyuncs.com/images/20221031/1e81c06c997c41f29304b7f16e204e02.png?x-oss-process=style/codedm" alt="开启自动压缩和分区提交DAG图"></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-10-21T09:00:00.000Z" title="10/21/2022, 5:00:00 PM">2022-10-21</time>发表</span><span class="level-item"><time dateTime="2023-02-02T03:32:36.841Z" title="2/2/2023, 11:32:36 AM">2023-02-02</time>更新</span><span class="level-item">2 分钟读完 (大约254个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/posts/77cd4175.html">README</a></h1><div class="content"><p>Hello 大家好我是Codedm，这个仓库主要是和大家分享一些关于Java生态的技术。<br>主要包括Java 基础、Java 进阶、Flink、大数据、算法、Java Web等等</p>
<h2 id="文章导航"><a href="#文章导航" class="headerlink" title="文章导航"></a>文章导航</h2><ul>
<li>post文件夹：所有技术文章，子文件夹按照文章类型分类</li>
<li>src：关于文章中出现的源码</li>
</ul>
<h2 id="文章特点"><a href="#文章特点" class="headerlink" title="文章特点"></a>文章特点</h2><ul>
<li>每篇文章都会有对应的 issues：issues中记录了我在写文章的过程，做了哪些POC，参考的文章连接。</li>
</ul>
<h2 id="文章发布过程"><a href="#文章发布过程" class="headerlink" title="文章发布过程"></a>文章发布过程</h2><p>大家可以通过这个连接查看这个仓库的历史创作以及未来创作。<br><a target="_blank" rel="noopener" href="https://github.com/users/code-dm/projects/1">https://github.com/users/code-dm/projects/1</a></p>
<h2 id="博客地址"><a href="#博客地址" class="headerlink" title="博客地址"></a>博客地址</h2><p><a href="https://codedm.com/">https://codedm.com/</a></p>
<h2 id="关注我"><a href="#关注我" class="headerlink" title="关注我"></a>关注我</h2><p><img src="https://codedm.oss-cn-hangzhou.aliyuncs.com/images/20220913/4d349aec8917438da7d75d0cd85dc954.png?x-oss-process=style/codedm" alt="关注我"></p>
<h2 id="添加我的微信"><a href="#添加我的微信" class="headerlink" title="添加我的微信"></a>添加我的微信</h2><p><img src="https://codedm.oss-cn-hangzhou.aliyuncs.com/images/20220913/79376422e6cb4e78aeabbb024494cda1.png?x-oss-process=style/codedm" alt="添加微信"></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-10-21T09:00:00.000Z" title="10/21/2022, 5:00:00 PM">2022-10-21</time>发表</span><span class="level-item"><time dateTime="2023-02-02T03:31:26.911Z" title="2/2/2023, 11:31:26 AM">2023-02-02</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/">领域驱动设计</a></span><span class="level-item">2 分钟读完 (大约300个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/posts/d3721390.html">领域驱动设计-什么是领域</a></h1><div class="content"><h1 id="领域驱动设计-什么是领域"><a href="#领域驱动设计-什么是领域" class="headerlink" title="领域驱动设计-什么是领域"></a>领域驱动设计-什么是领域</h1><blockquote>
<p>– Eric Evans, Domain-Driven Design:<br>Every software program relates to some activity or interest of its user. That subject area to which the user applies the program is the domain of the software. Some domains involve the physical world: The domain of an airline booking program involves real people getting on real aircraft. Some domains are intangible: the domain of an accounting program is money and finance. Software domains usually have little to do with computers, though there are exceptions: the domain of a source-code control system is software development itself. – Eric Evans, Domain-Driven Design.</p>
</blockquote>
<p>翻译：</p>
<blockquote>
<p>每个软件程序都与用户的某些活动或兴趣有关。用户应用该程序的主题领域就是该软件的领域。有些领域涉及物理世界。航空公司订票程序的领域涉及到真正的人登上真正的飞机。有些领域是无形的：一个会计程序的领域是金钱和财务。软件领域通常与计算机关系不大，但也有例外：源代码控制系统的领域就是软件开发本身。– 埃里克-埃文斯，领域驱动设计。</p>
</blockquote>
<p>如何精炼业务域：<br>领域愿景说明<br>突出机制<br>内聚机制<br>分离的核心<br>抽象核心 </p>
</div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/">上一页</a></div><div class="pagination-next"><a href="/page/3/">下一页</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><a class="pagination-link is-current" href="/page/2/">2</a></li><li><a class="pagination-link" href="/page/3/">3</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/codedm-logo.png" alt="Codedm"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Codedm</p><p class="is-size-6 is-block">Codedm的Java小站</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>中国 * 南京</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">21</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">6</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">0</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/Code-dm" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/Code-dm"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Zhihu" href="https://www.zhihu.com/people/zhi-zhe-hu-zhi-zhe"><i class="fab fa-zhihu"></i></a></div></div></div><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Docker/"><span class="level-start"><span class="level-item">Docker</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Flink/"><span class="level-start"><span class="level-item">Flink</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/categories/Java%E5%9F%BA%E7%A1%80/"><span class="level-start"><span class="level-item">Java基础</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%A1%AB%E5%86%99%E5%88%86%E7%B1%BB/"><span class="level-start"><span class="level-item">填写分类</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/"><span class="level-start"><span class="level-item">大数据</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/"><span class="level-start"><span class="level-item">领域驱动设计</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2022/10/"><span class="level-start"><span class="level-item">十月 2022</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/09/"><span class="level-start"><span class="level-item">九月 2022</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/08/"><span class="level-start"><span class="level-item">八月 2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/07/"><span class="level-start"><span class="level-item">七月 2022</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li></ul></div></div></div><!--!--><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-10-23T16:00:00.000Z">2022-10-24</time></p><p class="title"><a href="/posts/89c758e.html">数据湖初步探索</a></p><p class="categories"><a href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-10-21T09:00:00.000Z">2022-10-21</time></p><p class="title"><a href="/posts/77cd4175.html">README</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-10-21T09:00:00.000Z">2022-10-21</time></p><p class="title"><a href="/posts/d3721390.html">领域驱动设计-什么是领域</a></p><p class="categories"><a href="/categories/%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/">领域驱动设计</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-10-11T09:00:00.000Z">2022-10-11</time></p><p class="title"><a href="/posts/573ecee0.html">Flink Hive 合并小文件原理</a></p><p class="categories"><a href="/categories/Flink/">Flink</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-09-21T03:00:00.000Z">2022-09-21</time></p><p class="title"><a href="/posts/805c09f3.html">Flink如何适配Hive中不同的数据存储格式</a></p><p class="categories"><a href="/categories/Flink/">Flink</a></p></div></article></div></div><!--!--></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">Codedm</a><p class="is-size-7"><span>&copy; 2023 Codedm</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p></div></div></div></div></footer><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" defer></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdnjs.cloudflare.com/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/lightgallery/1.10.0/js/lightgallery.min.js" defer></script><script src="https://cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>